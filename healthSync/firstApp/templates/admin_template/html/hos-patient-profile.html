{% load static %}
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Dossier Patient</title>
    <meta content="" name="description" />
    <meta content="" name="author" />
    <link rel="shortcut icon" href="{% static 'admin/assets/images/favicon.png' %}" type="image/x-icon" />
    <link rel="apple-touch-icon-precomposed" href="{% static 'admin/assets/images/apple-touch-icon-57-precomposed.png' %}">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="{% static 'admin/assets/images/apple-touch-icon-114-precomposed.png' %}">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="{% static 'admin/assets/images/apple-touch-icon-72-precomposed.png' %}">
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="{% static 'admin/assets/images/apple-touch-icon-144-precomposed.png' %}">
    <!-- CORE CSS FRAMEWORK - START -->
    <link href="{% static 'admin/assets/plugins/pace/pace-theme-flash.css' %}" rel="stylesheet" type="text/css" media="screen" />
    <link href="{% static 'admin/assets/plugins/bootstrap/css/bootstrap.min.css' %}" rel="stylesheet" type="text/css" />
    <link href="{% static 'admin/assets/plugins/bootstrap/css/bootstrap-theme.min.css' %}" rel="stylesheet" type="text/css" />
    <link href="{% static 'admin/assets/fonts/font-awesome/css/font-awesome.css' %}" rel="stylesheet" type="text/css" />
    <link href="{% static 'admin/assets/fonts/webfont/cryptocoins.css' %}" rel="stylesheet" type="text/css" />
    <link href="{% static 'admin/assets/css/animate.min.css' %}" rel="stylesheet" type="text/css" />
    <link href="{% static 'admin/assets/plugins/perfect-scrollbar/perfect-scrollbar.css' %}" rel="stylesheet" type="text/css" />
    <!-- CORE CSS FRAMEWORK - END -->
    <!-- CORE CSS TEMPLATE - START -->
    <link href="{% static 'admin/assets/css/style.css' %}" rel="stylesheet" type="text/css" />
    <link href="{% static 'admin/assets/css/responsive.css' %}" rel="stylesheet" type="text/css" />
    <!-- CORE CSS TEMPLATE - END -->
</head>
<body>
    {% include "admin_template/partials/_header.html" %}
    <div class="page-container row-fluid container-fluid">
        {% include "admin_template/partials/_sidebar.html" %}
        <section id="main-content">
            <div class="wrapper main-wrapper row">
                <div class='col-xs-12'>
                    <div class="page-title">
                        <div class="pull-left">
                            <h1 class="title">Dossier du patient</h1>
                        </div>
                    </div>
                </div>
                <div class="clearfix"></div>

                <div class="col-lg-4">
                    <section class="box">
                        <div class="content-body p">
                            <div class="row">
                                <div class="doctors-list patient relative">
                                    <div class="doctors-head relative text-center">
                                        <div class="patient-img img-circle">
                                            {% if patient.photo %}
                                                <img src="{{ patient.photo.url }}" class="rad-50 center-block" alt="">
                                            {% else %}
                                                <img src="{% static 'admin/data/profile/1430504.png' %}" class="rad-50 center-block" alt="">
                                            {% endif %}
                                            <div class="stutas"></div>
                                        </div>
                                        <h3 class="header w-text relative bold">Nom : {{ patient.nom }} {{ patient.prenom }}</h3>
                                        <p class="desc g-text relative">{{ patient.email }}</p>
                                    </div>
                                    <div class="row">
                                        <div class="patients-info relative">
                                            <div class="col-sm-6 col-xs-12">
                                                <div class="patient-card has-shadow2">
                                                    <div class="doc-info-wrap">
                                                        <div class="patient-info">
                                                            <h5 class="bold">
                                                                {% if patient.sexe == "M" %}Masculin{% elif patient.sexe == "F" %}Féminin{% else %}{{ patient.sexe }}{% endif %}
                                                            </h5>
                                                            <h6>Genre</h6>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-6 col-xs-12">
                                                <div class="patient-card has-shadow2">
                                                    <div class="doc-info-wrap">
                                                        <div class="patient-info">
                                                            <h5 class="bold">Age: {{ patient.age }}</h5>
                                                            <h6>Ans</h6>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div><!-- end row -->
                                </div>
                            </div>
                        </div>
                    </section>
                </div>

                <div class="col-lg-8 col-md-12">
                    <div class="row">
                        <div class="col-xs-12">
                            <section class="box gradient-blue" style="padding:20px">
                                <h4 class="w-text">Allergies :</h4>
                                <p class="mb-0 g-text">{{ dossier.liste_allergie|default:"Aucune" }}</p>
                                <h4 class="w-text">Vaccins :</h4>
                                <p class="mb-0 g-text">{{ dossier.list_vaccin|default:"Aucun" }}</p>
                                <h4 class="w-text">Antécédents médicaux :</h4>
                                <p class="mb-0 g-text">{{ dossier.antecedant_medicaux|default:"Aucun" }}</p>
                                {% if can_edit_dossier %}
                                    <a href="{% url 'edit_dossier_patient' dossier.id %}" class="btn btn-warning mt-10"><i class="fa fa-pencil"></i> Modifier le dossier</a>
                                {% endif %}
                            </section>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-xs-12">
                            <section class="box">
                                <header class="panel_header">
                                    <h2 class="title pull-left">Historique journalier</h2>
                                    {% if can_add_page %}
                                        <a href="{% url 'add_page_dossier_patient' dossier.id %}" class="btn btn-success pull-right"><i class="fa fa-plus"></i> Nouvelle page (jour)</a>
                                    {% endif %}
                                </header>
                                <div class="content-body">
                                    {% if dossier.pages.exists %}
                                        <table class="table table-bordered">
                                            <thead>
                                                <tr>
                                                    <th>Page carnet</th>
                                                    <th>Date</th>
                                                    <th>Température</th>
                                                    <th>Médicaments</th>
                                                    <th>Actions</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {% for page in dossier.pages.all %}
                                                <tr>
                                                    <td>{{ forloop.counter }}</td>
                                                    <td>{{ page.date }}</td>
                                                    <td>{{ page.temperature|default:"-" }}</td>
                                                    <td>{{ page.medicaments|default:"-" }}</td>
                                                    <td>
                                                        {% if can_edit_page %}
                                                            <a href="{% url 'edit_page_dossier_patient' page.id %}" class="btn btn-xs btn-info"><i class="fa fa-pencil"></i> Modifier</a>
                                                        {% endif %}
                                                    </td>
                                                </tr>
                                                {% if role == 'medecin' and page.resume_consultation %}
                                                <tr>
                                                    <td colspan="5" style="background:#f5f8fa">
                                                        <strong>Résumé de la consultation :</strong>
                                                        <div>{{ page.resume_consultation }}</div>
                                                    </td>
                                                </tr>
                                                {% endif %}
                                                {% endfor %}
                                            </tbody>
                                        </table>
                                    {% else %}
                                        <div class="alert alert-info">Aucune page de dossier enregistrée pour ce patient.</div>
                                    {% endif %}
                                </div>
                            </section>
                        </div>
                    </div>
                </div>
                <div class="clearfix"></div>
            </div>
        </section>
    </div>
    <!-- CORE JS FRAMEWORK - START -->
    <script src="{% static 'admin/assets/js/jquery.min.js' %}"></script>
    <script src="{% static 'admin/assets/js/jquery.easing.min.js' %}"></script>
    <script src="{% static 'admin/assets/plugins/bootstrap/js/bootstrap.min.js' %}"></script>
    <script src="{% static 'admin/assets/plugins/pace/pace.min.js' %}"></script>
    <script src="{% static 'admin/assets/plugins/perfect-scrollbar/perfect-scrollbar.min.js' %}"></script>
    <script src="{% static 'admin/assets/plugins/viewport/viewportchecker.js' %}"></script>
    <script>
        window.jQuery || document.write('<script src="{% static 'admin/assets/js/jquery.min.js' %}"><\/script>');
    </script>
    <!-- CORE JS FRAMEWORK - END -->
    <!-- CORE TEMPLATE JS - START -->
    <script src="{% static 'admin/assets/js/scripts.js' %}"></script>
    <!-- END CORE TEMPLATE JS - END -->
</body>
</html>